const a10_0x558e=['start','createMetricRecorder','data','hash','parallel','next','../../../utilities/metric-logger','../../../utilities/nx-imports-light','then','value','VERBOSE_LOGGING','message','false','map','__esModule','DistributedExecutionApi','dteStart','/nx-cloud/executions/status','apiAxiosInstance','error','defineProperty','throw','createStartRequest','serializeOverrides','status','recordMetric','../../../utilities/serializer-overrides','post','__awaiter','response','/nx-cloud/executions/complete-run-group','axiosMultipleTries','RUNNER_FAILURE_PERF_ENTRY','NX_CLOUD_DISTRIBUTED_EXECUTION_AGENT_COUNT','axiosException','exit','true','../../../utilities/environment','project','Workspace\x20is\x20disabled.\x20Cannot\x20perform\x20distributed\x20task\x20executions.','mapRespToPerfEntry','Completing\x20with\x20an\x20error','completeRunGroup','completeRunGroupWithError','maxParallel','enabled','error:\x20','NX_CLOUD_DISTRIBUTED_EXECUTION_STOP_AGENTS_ON_FAILURE','note','agentCount','target'];(function(_0x28b25b,_0x558e54){const _0x49200c=function(_0x394341){while(--_0x394341){_0x28b25b['push'](_0x28b25b['shift']());}};_0x49200c(++_0x558e54);}(a10_0x558e,0x10f));const a10_0x4920=function(_0x28b25b,_0x558e54){_0x28b25b=_0x28b25b-0x0;let _0x49200c=a10_0x558e[_0x28b25b];return _0x49200c;};'use strict';var __awaiter=this&&this[a10_0x4920('0xc')]||function(_0x5cca40,_0x1f2948,_0x3f66e6,_0x166537){function _0x437353(_0x9e0706){return _0x9e0706 instanceof _0x3f66e6?_0x9e0706:new _0x3f66e6(function(_0x3f8ee6){_0x3f8ee6(_0x9e0706);});}return new(_0x3f66e6||(_0x3f66e6=Promise))(function(_0x13e0a6,_0x4393b5){function _0x5cfccd(_0x3f185b){try{_0x5c2119(_0x166537[a10_0x4920('0x28')](_0x3f185b));}catch(_0x1f8b2f){_0x4393b5(_0x1f8b2f);}}function _0xf06a13(_0x19abcd){try{_0x5c2119(_0x166537[a10_0x4920('0x5')](_0x19abcd));}catch(_0x5902df){_0x4393b5(_0x5902df);}}function _0x5c2119(_0x333aac){_0x333aac['done']?_0x13e0a6(_0x333aac['value']):_0x437353(_0x333aac[a10_0x4920('0x2c')])[a10_0x4920('0x2b')](_0x5cfccd,_0xf06a13);}_0x5c2119((_0x166537=_0x166537['apply'](_0x5cca40,_0x1f2948||[]))[a10_0x4920('0x28')]());});};Object[a10_0x4920('0x4')](exports,a10_0x4920('0x31'),{'value':!![]});exports[a10_0x4920('0x6')]=exports[a10_0x4920('0x32')]=void 0x0;const axios_1=require('../../../utilities/axios');const environment_1=require(a10_0x4920('0x15'));const metric_logger_1=require(a10_0x4920('0x29'));const serializer_overrides_1=require(a10_0x4920('0xa'));const {output}=require(a10_0x4920('0x2a'));class DistributedExecutionApi{constructor(_0x3083b0){this[a10_0x4920('0x2')]=(0x0,axios_1['createApiAxiosInstance'])(_0x3083b0);}[a10_0x4920('0x23')](_0x7c90be){var _0x2181da;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x17d224=(0x0,metric_logger_1[a10_0x4920('0x24')])(a10_0x4920('0x0'));let _0x3dd254;if(environment_1[a10_0x4920('0x2d')]){output[a10_0x4920('0x20')]({'title':'Starting\x20a\x20distributed\x20execution','bodyLines':[JSON['stringify'](_0x7c90be,null,0x2)]});}try{_0x3dd254=yield(0x0,axios_1[a10_0x4920('0xf')])(()=>this[a10_0x4920('0x2')]['post']('/nx-cloud/executions/start',_0x7c90be));_0x17d224[a10_0x4920('0x9')]((0x0,metric_logger_1['mapRespToPerfEntry'])(_0x3dd254));}catch(_0x1f0d36){_0x17d224[a10_0x4920('0x9')](((_0x2181da=_0x1f0d36===null||_0x1f0d36===void 0x0?void 0x0:_0x1f0d36['axiosException'])===null||_0x2181da===void 0x0?void 0x0:_0x2181da[a10_0x4920('0xd')])?(0x0,metric_logger_1[a10_0x4920('0x18')])(_0x1f0d36[a10_0x4920('0x12')][a10_0x4920('0xd')]):metric_logger_1[a10_0x4920('0x10')]);throw _0x1f0d36;}if(!_0x3dd254[a10_0x4920('0x25')][a10_0x4920('0x1d')]){throw new Error(a10_0x4920('0x17'));}if(_0x3dd254[a10_0x4920('0x25')][a10_0x4920('0x3')]){throw new Error(_0x3dd254[a10_0x4920('0x25')][a10_0x4920('0x3')]);}return _0x3dd254[a10_0x4920('0x25')]['id'];});}[a10_0x4920('0x8')](_0x37ac28){var _0x2cdf1d;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x24421e=(0x0,metric_logger_1[a10_0x4920('0x24')])('dteStatus');try{const _0x41acf7=yield(0x0,axios_1[a10_0x4920('0xf')])(()=>this[a10_0x4920('0x2')][a10_0x4920('0xb')](a10_0x4920('0x1'),{'id':_0x37ac28}));_0x24421e[a10_0x4920('0x9')]((0x0,metric_logger_1[a10_0x4920('0x18')])(_0x41acf7));return _0x41acf7['data'];}catch(_0x8202bb){_0x24421e[a10_0x4920('0x9')](((_0x2cdf1d=_0x8202bb===null||_0x8202bb===void 0x0?void 0x0:_0x8202bb[a10_0x4920('0x12')])===null||_0x2cdf1d===void 0x0?void 0x0:_0x2cdf1d[a10_0x4920('0xd')])?(0x0,metric_logger_1['mapRespToPerfEntry'])(_0x8202bb[a10_0x4920('0x12')][a10_0x4920('0xd')]):metric_logger_1['RUNNER_FAILURE_PERF_ENTRY']);output[a10_0x4920('0x3')]({'title':_0x8202bb[a10_0x4920('0x2e')]});process[a10_0x4920('0x13')](0x1);}});}[a10_0x4920('0x1b')](_0x2dc7bd,_0x4c8482,_0xf3b7f5,_0x127955,_0x4e2540){var _0x24adcd;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x1ba1f8=(0x0,metric_logger_1['createMetricRecorder'])(a10_0x4920('0x1a'));if(environment_1[a10_0x4920('0x2d')]){output[a10_0x4920('0x20')]({'title':a10_0x4920('0x19'),'bodyLines':['ciExecutionId:\x20'+_0xf3b7f5,'ciExecutionEnv:\x20'+_0x127955,'runGroup:\x20'+_0x4c8482,a10_0x4920('0x1e')+_0x4e2540]});}try{const _0x428924=yield(0x0,axios_1[a10_0x4920('0xf')])(()=>this[a10_0x4920('0x2')]['post'](a10_0x4920('0xe'),{'branch':_0x2dc7bd,'runGroup':_0x4c8482,'ciExecutionId':_0xf3b7f5,'ciExecutionEnv':_0x127955,'criticalErrorMessage':_0x4e2540}),0x3);_0x1ba1f8[a10_0x4920('0x9')]((0x0,metric_logger_1[a10_0x4920('0x18')])(_0x428924));}catch(_0x5fc429){_0x1ba1f8[a10_0x4920('0x9')](((_0x24adcd=_0x5fc429===null||_0x5fc429===void 0x0?void 0x0:_0x5fc429['axiosException'])===null||_0x24adcd===void 0x0?void 0x0:_0x24adcd['response'])?(0x0,metric_logger_1[a10_0x4920('0x18')])(_0x5fc429[a10_0x4920('0x12')][a10_0x4920('0xd')]):metric_logger_1[a10_0x4920('0x10')]);}});}}exports[a10_0x4920('0x32')]=DistributedExecutionApi;function createStartRequest(_0x556c7f,_0x37349b,_0x146e22,_0x2182cb,_0x9b6eda,_0x5edb8f,_0x5a38b2){const _0x27e286=_0x9b6eda[a10_0x4920('0x30')](_0x5041f0=>{return _0x5041f0[a10_0x4920('0x30')](_0x478087=>{return{'taskId':_0x478087['id'],'hash':_0x478087[a10_0x4920('0x26')],'projectName':_0x478087[a10_0x4920('0x22')][a10_0x4920('0x16')],'target':_0x478087[a10_0x4920('0x22')]['target'],'configuration':_0x478087['target']['configuration']||null,'params':(0x0,serializer_overrides_1[a10_0x4920('0x7')])(_0x478087)};});});const _0x27fd9c={'command':(0x0,environment_1['parseCommand'])(),'branch':_0x556c7f,'runGroup':_0x37349b,'ciExecutionId':_0x146e22,'ciExecutionEnv':_0x2182cb,'tasks':_0x27e286,'maxParallel':calculateMaxParallel(_0x5edb8f),'commitSha':_0x5a38b2};if(environment_1[a10_0x4920('0x11')]){_0x27fd9c[a10_0x4920('0x21')]=environment_1[a10_0x4920('0x11')];}if(!environment_1[a10_0x4920('0x1f')]){_0x27fd9c['stopAgentsOnFailure']=![];}return _0x27fd9c;}exports['createStartRequest']=createStartRequest;function calculateMaxParallel(_0x3a8126){if(_0x3a8126[a10_0x4920('0x27')]===a10_0x4920('0x2f')||_0x3a8126[a10_0x4920('0x27')]===![]){return 0x1;}else if(_0x3a8126[a10_0x4920('0x27')]===a10_0x4920('0x14')||_0x3a8126['parallel']===!![]){return Number(_0x3a8126[a10_0x4920('0x1c')]||0x3);}else if(_0x3a8126[a10_0x4920('0x27')]===undefined){return _0x3a8126[a10_0x4920('0x1c')]?Number(_0x3a8126[a10_0x4920('0x1c')]):0x3;}else{return Number(_0x3a8126[a10_0x4920('0x27')])||0x3;}}