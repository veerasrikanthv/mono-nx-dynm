"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.setParallelDefault = void 0;
const devkit_1 = require("@nx/devkit");
async function setParallelDefault(host) {
    const config = (0, devkit_1.readNxJson)(host);
    const defaultTaskRunnerOptions = config.tasksRunnerOptions?.['default']?.options;
    if (defaultTaskRunnerOptions) {
        if (defaultTaskRunnerOptions.parallel) {
            defaultTaskRunnerOptions.parallel =
                defaultTaskRunnerOptions.maxParallel || 3;
            delete defaultTaskRunnerOptions.maxParallel;
        }
        else {
            defaultTaskRunnerOptions.parallel = 1;
        }
        (0, devkit_1.updateNxJson)(host, config);
    }
    await (0, devkit_1.formatFiles)(host);
}
exports.setParallelDefault = setParallelDefault;
exports.default = setParallelDefault;
