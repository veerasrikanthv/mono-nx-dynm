"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.setDefaultBaseIfNotSet = void 0;
const devkit_1 = require("@nx/devkit");
const output_1 = require("../../utilities/output");
async function setDefaultBaseIfNotSet(host) {
    const config = (0, devkit_1.readNxJson)(host);
    if (!config.affected?.defaultBase) {
        config.affected ??= {};
        config.affected.defaultBase ??= 'master';
        output_1.output.note({
            title: 'Default Base has been set in nx.json',
            bodyLines: [
                `Nx is moving to "main" as the default branch.`,
                `To avoid your current defaults changing, defaultBase has been set to "master" in nx.json`,
                `Read more here: https://nx.dev/using-nx/affected`,
            ],
        });
    }
    (0, devkit_1.updateNxJson)(host, config);
    await (0, devkit_1.formatFiles)(host);
}
exports.setDefaultBaseIfNotSet = setDefaultBaseIfNotSet;
exports.default = setDefaultBaseIfNotSet;
